<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>C#æ‰˜ç®¡å †å’Œåƒåœ¾å›æ”¶</title>
    <url>/2021/02/05/C-%E6%89%98%E7%AE%A1%E5%A0%86%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/</url>
    <content><![CDATA[<h2 id="æ‰˜ç®¡å †åŸºç¡€"><a class="header-anchor" href="#æ‰˜ç®¡å †åŸºç¡€">Â¶</a>æ‰˜ç®¡å †åŸºç¡€</h2>
<h3 id="åˆ†é…èµ„æº"><a class="header-anchor" href="#åˆ†é…èµ„æº">Â¶</a>åˆ†é…èµ„æº</h3>
<p>C#è¦æ±‚æ‰€æœ‰å¯¹è±¡éƒ½ä»<strong>æ‰˜ç®¡å †</strong>åˆ†é…ã€‚è¿›ç¨‹åˆå§‹åŒ–æ—¶ï¼ŒCLRåˆ’å‡ºä¸€ä¸ªåœ°å€ç©ºé—´åŒºåŸŸä½œä¸ºæ‰˜ç®¡å †ã€‚CLRè¿˜ä¼šç»´æŠ¤ä¸€ä¸ªå«<strong>NextObjPtr</strong>çš„æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå¯¹è±¡åœ¨å †ä¸­çš„ä½ç½®ã€‚</p>
<p>ä¸€ä¸ªåŒºåŸŸè¢«éåƒåœ¾å¡«æ»¡åï¼ŒCLRä¼šåˆ†é…æ›´å¤šçš„åŒºåŸŸå‡ºæ¥ï¼Œä¸€ç›´é‡å¤ï¼Œç›´åˆ°è¿›ç¨‹åœ°å€ç©ºé—´è¢«å¡«æ»¡ã€‚(32ä½è¿›ç¨‹æœ€å¤šèƒ½åˆ†é…1.5GB;64ä½è¿›ç¨‹æœ€å¤šèƒ½åˆ†é…8TB)</p>
<a id="more"></a>
<p>c#çš„newå…³é”®å­—å®é™…ä¸Šæ‰§è¡Œäº†ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>è®¡ç®—ç±»å‹çš„å­—æ®µæ‰€éœ€çš„å­—èŠ‚æ•°ã€‚</li>
<li>åŠ ä¸Šå¯¹è±¡å¼€é”€æ‰€éœ€çš„å­—èŠ‚æ•°(æ¯ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªå¼€é”€å­—æ®µï¼š<strong>ç±»å‹å¯¹è±¡æŒ‡é’ˆ</strong>å’Œ<strong>åŒæ­¥å—ç´¢å¼•</strong>)ã€‚</li>
<li>CLRæ£€æŸ¥åŒºåŸŸä¸­æ˜¯å¦æœ‰è¶³å¤Ÿåˆ†é…å¯¹è±¡æ‰€éœ€çš„å­—èŠ‚æ•°ã€‚å¦‚æœæœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œå°±åœ¨<strong>NextObjPtr</strong>å¤„æ”¾å…¥è¯¥å¯¹è±¡ï¼Œå¹¶ä¸”å°†<strong>NextObjPtr</strong>è¿”å›ç»™ç±»å‹çš„æ„é€ å™¨(<strong>this</strong>)ã€‚<strong>NextObjPtr</strong>ä¼šåœ¨è‡ªèº«çš„åŸºç¡€ä¸ŠåŠ ä¸Šå¯¹è±¡å ç”¨çš„å­—èŠ‚æ•°æ¥å¾—åˆ°ä¸€ä¸ªæ–°å€¼ï¼Œå³ä¸‹ä¸€ä¸ªå¯¹è±¡çš„åœ°å€ã€‚</li>
</ol>
<p><img src="https://i.loli.net/2021/02/01/uGlTUWacveLp7bx.png" alt="åˆå§‹åŒ–æ‰˜ç®¡å †"></p>
<h3 id="åƒåœ¾å›æ”¶ç®—æ³•"><a class="header-anchor" href="#åƒåœ¾å›æ”¶ç®—æ³•">Â¶</a>åƒåœ¾å›æ”¶ç®—æ³•</h3>
<p>CLRçš„åƒåœ¾å›æ”¶æœºåˆ¶é‡‡ç”¨çš„æ˜¯<strong>å¼•ç”¨è·Ÿè¸ªç®—æ³•</strong>ï¼Œè¯¥ç®—æ³•åªå…³å¿ƒå¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œå› ä¸ºåªæœ‰è¿™ç§å˜é‡æ‰èƒ½å¼•ç”¨å †ä¸Šçš„å¯¹è±¡ã€‚æˆ‘ä»¬å°†æ‰€æœ‰è¿™äº›å¼•ç”¨ç±»å‹çš„å˜é‡ç§°ä¸º<strong>æ ¹</strong>ã€‚</p>
<p>åƒåœ¾å›æ”¶çš„æœºåˆ¶æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>åƒåœ¾å›æ”¶å¼€å§‹æ—¶ï¼ŒCLRé¦–å…ˆæš‚åœæ‰€æœ‰çº¿ç¨‹(é˜²æ­¢æ£€æŸ¥æœŸé—´å¯¹è±¡çŠ¶æ€æ”¹å˜)ã€‚</li>
<li>è¿›å…¥æ ‡è®°é˜¶æ®µï¼ŒCLRéå†å †ä¸Šçš„æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶å°†åŒæ­¥å—ç´¢å¼•ä¸­çš„æŸä¸€ä½è®¾ç½®ä¸º0(æ ‡è®°ä¸º0æ—¶è¡¨ç¤ºå¯¹è±¡éœ€è¦è¢«åˆ é™¤)ã€‚</li>
<li>CLRæ£€æŸ¥æ‰€æœ‰<strong>æ ¹</strong>ï¼Œå¦‚æœè¿™ä¸ªæ ¹å¼•ç”¨äº†å †ä¸Šçš„å¯¹è±¡ï¼Œé‚£ä¹ˆCLRä¼šæ ‡è®°è¿™ä¸ªå¯¹è±¡ï¼Œå°†åŒæ­¥å—ç´¢å¼•çš„å€¼ä¿®æ”¹ä¸º1ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡è¢«æ ‡è®°ï¼ŒCLRè¿˜ä¼šæ£€æŸ¥é‚£ä¸ªå¯¹è±¡ä¸­çš„æ ¹ï¼Œæ ‡è®°ä»–ä»¬å¼•ç”¨çš„å¯¹è±¡ã€‚<br>
å¦‚ä¸‹å›¾ï¼ŒBå¯¹è±¡å«æœ‰ä¸€ä¸ªEå¯¹è±¡çš„å¼•ç”¨ï¼Œæ ‡è®°Bå¯¹è±¡çš„åŒæ—¶ä¹Ÿä¼šæ ‡è®°Eå¯¹è±¡ã€‚</li>
</ol>
<p><img src="https://i.loli.net/2021/02/01/RLEY5iZUDfWQn9c.png" alt="åƒåœ¾å›æ”¶å‰çš„å †çŠ¶æ€"></p>
<ol start="4">
<li>æ£€æŸ¥å®Œæˆåï¼Œå †ä¸­çš„å¯¹è±¡åˆ†ä¸ºå·²æ ‡è®°å’Œæœªæ ‡è®°ä¸¤ç§çŠ¶æ€ã€‚</li>
</ol>
<ul>
<li>å·²æ ‡è®°çš„å¯¹è±¡ä¸èƒ½è¢«åƒåœ¾å›æ”¶ï¼Œå› ä¸ºæœ‰æ ¹çš„å¼•ç”¨ï¼Œæˆ‘ä»¬æˆä¸º<strong>å¯è¾¾</strong>ã€‚</li>
<li>æœªæ ‡è®°çš„å¯¹è±¡å°†è¢«å›æ”¶ï¼Œå› ä¸ºå·²ç»æ²¡æœ‰æ ¹çš„å¼•ç”¨ï¼Œæˆ‘ä»¬æˆä¸º<strong>ä¸å¯è¾¾</strong>ã€‚</li>
</ul>
<ol start="5">
<li>CLRè¿›å…¥(å‹ç¼©)é˜¶æ®µï¼Œé¦–å…ˆå°†<strong>å¯è¾¾</strong>çš„éƒ¨åˆ†è¿ç»­æ’åˆ—ã€‚åœ¨å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºä¼šç§»åŠ¨å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œæ‰€ä»¥CLRè¿˜éœ€è¦é‡æ–°ä¸ºæ¯ä¸ªå¯¹è±¡è®¡ç®—æ–°çš„æŒ‡é’ˆä½ç½®ã€‚å‹ç¼©å®Œæˆåï¼Œ<strong>NextObjPtr</strong>å°†æŒ‡å‘æœ€åä¸€ä¸ª<strong>å¯è¾¾</strong>å¯¹è±¡çš„ä½ç½®ã€‚</li>
</ol>
<p><img src="https://i.loli.net/2021/02/01/bQlMRgHjqxfsO9C.png" alt="å‹ç¼©åçš„å †çŠ¶æ€"></p>
<p>è¿™éƒ¨åˆ†åªæ˜¯ç®€å•ä»‹ç»ä¸‹æ‰˜ç®¡å †çš„åˆå§‹åŒ–å’Œåƒåœ¾å›æ”¶çš„åŸºæœ¬ç®—æ³•ã€‚<br>
åé¢ä¼šç»§ç»­å¼€æ–‡ç« æˆ–è€…è¡¥å……å…·ä½“æ¯ä¸€ä»£æ˜¯å¦‚ä½•è¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚</p>
]]></content>
      <categories>
        <category>.NET</category>
      </categories>
      <tags>
        <tag>.NET</tag>
        <tag>C#</tag>
        <tag>åƒåœ¾å›æ”¶</tag>
      </tags>
  </entry>
  <entry>
    <title>C#ä½¿ç”¨decimal.TryParseè½¬æ¢æ—¶ï¼Œå­—ç¬¦ä¸²ä¸­æœ‰é€—å·çš„å‘</title>
    <url>/2021/02/06/C-%E4%BD%BF%E7%94%A8decimal-TryParse%E8%BD%AC%E6%8D%A2%E6%97%B6%EF%BC%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E6%9C%89%E9%80%97%E5%8F%B7%E7%9A%84%E5%9D%91/</url>
    <content><![CDATA[<h2 id="èµ·æº"><a class="header-anchor" href="#èµ·æº">Â¶</a>èµ·æº</h2>
<p>ä¸€åˆ‡éƒ½è¦ä»é‚£ä¸ªçº¿ä¸Šbugè¯´èµ·ï¼Œæ‰§è¡Œ decimal.TryParse æ—¶ç¨‹åºå¹¶æ²¡æœ‰æŒ‰ç…§é¢„æœŸè¾“å‡ºç»“æœğŸ’”ğŸ’”ğŸ’”</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="built_in">string</span> input = <span class="string">&quot;1,2,3&quot;</span>;</span><br><span class="line"><span class="built_in">decimal</span> output;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">decimal</span>.TryParse(input, <span class="keyword">out</span> output))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;output&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Unable to decimal <span class="subst">&#123;input&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿™é‡Œæ„å¤–çš„è¾“å‡ºäº† 123</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>å› ä¸ºæŒ‰ç…§æˆ‘çš„ç†è§£è¿™é‡Œæ˜¯ä¸èƒ½æˆåŠŸè½¬æ¢çš„ï¼Œæ‰€ä»¥æ’æŸ¥é—®é¢˜çš„ç€é‡ç‚¹æ ¹æœ¬å°±æ²¡æ”¾åœ¨è¿™ï¼Œä»¥è‡³äºæ•´ä¸ªæ’æŸ¥è¿‡ç¨‹ä¹Ÿæ˜¾å¾—é¢‡ä¸ºè¾›è‹¦ã€‚</p>
<h2 id="æŸ¥çœ‹ç©¶ç«Ÿ"><a class="header-anchor" href="#æŸ¥çœ‹ç©¶ç«Ÿ">Â¶</a>æŸ¥çœ‹ç©¶ç«Ÿ</h2>
<p>å»MSDNä¸Šç¿»å¸®åŠ©æ–‡æ¡£ï¼Œå‘ç°TryParseæœ‰è¿™æ ·ä¸€ä¸ªé‡è½½æ–¹æ³•<br>
<img src="https://i.loli.net/2021/02/06/Hwfr16SxCT38yJm.png" alt="TryParseç¤ºä¾‹1.png"></p>
<p>çœ‹åˆ°Globalizationçš„æ—¶å€™å°±çŸ¥é“å‡‰äº†ä¸€åŠï¼Œåœ¨å¾€ä¸‹çœ‹ç¤ºä¾‹ï¼Œæœç„¶ï¼Œ<strong>è´§å¸ç¬¦å·</strong> ã€<strong>åƒåˆ†ä½</strong> ã€<strong>å°æ•°ç‚¹</strong> å…¨å‡ºæ¥äº†ã€‚<br>
<img src="https://i.loli.net/2021/02/06/JTMPyn4KHRS7a3X.png" alt="TryParseç¤ºä¾‹2.png"></p>
<p>ç°åœ¨é—®é¢˜å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘çš„ä»£ç æ²¡æœ‰è½¬æ¢å¤±è´¥å¾ˆæœ‰å¯èƒ½å°±æ˜¯å› ä¸º<strong>é€—å·è¢«è¯†åˆ«æˆäº†åƒåˆ†ä½</strong>ã€‚<br>
åç¼–è¯‘ä¸€ä¸‹ï¼Œå‘ç°è½¬æ¢çš„æ—¶å€™ç¡®å®ä½¿ç”¨äº†ä¸€ä¸ªé»˜è®¤å€¼ System.Globalization.NumberStyles.Numberã€‚<br>
<img src="https://i.loli.net/2021/02/06/yYKFJgzOPRL5BpA.png" alt="TryParseç¤ºä¾‹3.png"></p>
<p>ç»§ç»­æ¥çœ‹è¿™ä¸ªæšä¸¾å€¼ï¼Œå¾®è½¯å®˜æ–¹æ–‡æ¡£é‡Œç»™çš„è¯´æ˜å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>æŒ‡ç¤ºä½¿ç”¨ AllowLeadingWhiteã€AllowTrailingWhiteã€AllowLeadingSignã€AllowTrailingSignã€AllowDecimalPoint å’Œ AllowThousands æ ·å¼ã€‚ è¿™æ˜¯å¤åˆæ•°å­—æ ·å¼ã€‚<br>
<img src="https://i.loli.net/2021/02/06/TdZWN3b5fV7vDnh.png" alt="TryParseç¤ºä¾‹4.png"></p>
</blockquote>
<p>æˆ‘ä»¬ä»æœ€åä¸€ä¸ªç±»å‹ <strong>AllowThousands</strong> å¯ä»¥çœ‹å‡ºæ¥ï¼Œé»˜è®¤ç¡®å®ä½¿ç”¨äº†åƒåˆ†ä½ï¼Œæ‰€ä»¥åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­&quot;1,2,3&quot;çš„ç¡®èƒ½å¤ŸæˆåŠŸçš„å®Œæˆè½¬æ¢ã€‚</p>
<h2 id="é—®é¢˜å»¶ç”³"><a class="header-anchor" href="#é—®é¢˜å»¶ç”³">Â¶</a>é—®é¢˜å»¶ç”³</h2>
<p>é»˜è®¤ä½¿ç”¨äº†åƒåˆ†ä½è§£ææ²¡é”™ï¼Œä½†æ˜¯&quot;1,2,3&quot;è¿™ä¸ªå­—ç¬¦ä¸²çš„é€—å·ä¹Ÿæ²¡åœ¨å®é™…çš„åƒåˆ†ä½ä½ç½®ï¼Œè¿™åˆæ˜¯å’‹å›äº‹å‘¢ï¼Œæƒ³ä¸é€šã€‚ğŸ˜¨ğŸ˜¨ğŸ˜¨</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œçœ‹çœ‹ <strong>AllowThousands</strong> åˆæ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p>
<blockquote>
<p>æŒ‡ç¤ºæ•°å­—å­—ç¬¦ä¸²å¯ä»¥å…·æœ‰ç»„åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚å°†ç™¾ä½ä¸åƒä½åˆ†éš”å¼€æ¥çš„ç¬¦å·ã€‚ å¦‚æœ NumberStyles å€¼åŒ…æ‹¬ AllowCurrencySymbol æ ‡å¿—ï¼Œè¦åˆ†æçš„å­—ç¬¦ä¸²åŒ…æ‹¬è´§å¸ç¬¦å·ï¼Œåˆ™æœ‰æ•ˆç»„åˆ†éš”ç¬¦å­—ç¬¦ç”± CurrencyGroupSeparator å±æ€§ç¡®å®šï¼Œä¸”æ¯ä¸ªç»„ä¸­çš„ä½æ•°ç”± CurrencyGroupSizes å±æ€§ç¡®å®šã€‚ å¦åˆ™ï¼Œæœ‰æ•ˆçš„ç»„åˆ†éš”ç¬¦å­—ç¬¦ç”± NumberGroupSeparator å±æ€§ç¡®å®šï¼Œæ¯ç»„çš„ä½æ•°ç”± NumberGroupSizes å±æ€§ç¡®å®šã€‚</p>
</blockquote>
<p>ä»æ–‡æ¡£ä¸­æˆ‘ä»¬çŸ¥é“æ¯ç»„æ•°å­—çš„ä½æ•°ç”± <strong>NumberGroupSizes</strong> æ¥å†³å®šã€‚<br>
å›è¿‡å¤´æ¥ç»§ç»­çœ‹åˆšæ‰åç¼–è¯‘çš„ä»£ç ï¼ŒFormatInfoçš„å‚æ•°ä½¿ç”¨çš„<strong>NumberFormatInfo.CurrentInfo</strong>ï¼Œç°åœ¨æˆ‘ä»¬çœ‹ä¸‹<strong>NumberGroupSizes</strong>çš„å€¼åˆ°åº•æ˜¯å¤šå°‘ï¼ˆè°ƒè¯•å‘ç°é»˜è®¤åƒåˆ†ä½æ¯ç»„çš„ä½æ•°æ˜¯3ï¼‰ã€‚<br>
<img src="https://i.loli.net/2021/02/06/A19HK32ZukCyTOP.png" alt="TryParseç¤ºä¾‹5.png"></p>
<p>åˆ°è¿™é‡Œæˆ‘å·²ç»æ˜¯æ‘¸ä¸åˆ°å¤´ç»ªäº†ï¼Œæ‰€ä»¥å»ç½‘ä¸Šæœç´¢äº†ä¸€ä¸‹ï¼Œä½†æ˜¯ç»“æœä¹Ÿä¸ç†æƒ³ï¼Œæ€»ç»“ä¸€ä¸‹ç½‘ä¸Šå°±ä¸¤ç§ç»“è®ºï¼š</p>
<ol>
<li>æœ‰é€—å·æ—¶å¯ä»¥è½¬æ¢æˆåŠŸ</li>
<li>å¦‚æœè¦éªŒè¯åƒåˆ†ä½çš„ä½ç½®ï¼Œä½¿ç”¨æ­£åˆ™æ¥è¾…åŠ©</li>
</ol>
<h2 id="æ‰“ç ´ç ‚é”…å¹²åˆ°åº•"><a class="header-anchor" href="#æ‰“ç ´ç ‚é”…å¹²åˆ°åº•">Â¶</a>æ‰“ç ´ç ‚é”…å¹²åˆ°åº•</h2>
<p>ç½‘ä¸Šæ‰¾ä¸åˆ°æ»¡æ„çš„ç­”æ¡ˆï¼Œé‚£å°±åªèƒ½ç ”ç©¶ä¸€ä¸‹.Netçš„æºç äº†ï¼Œæ‰€ä»¥æˆ‘å¯¹ decimal.TryParse æ–¹æ³•è¿›è¡Œäº†è°ƒè¯•ï¼Œç»ˆäºå¼„æ¸…äº†è¿™ä¸ªåŸå› ã€‚ä¸‹é¢æ”¾ä¸€éƒ¨åˆ†å…³é”®ä»£ç ï¼š</p>
<p><img src="https://i.loli.net/2021/02/07/v6e721mcqQW5Vgz.png" alt="TryParseç¤ºä¾‹6.png"><br>
<img src="https://i.loli.net/2021/02/07/zLW6NXwUioxe2af.png" alt="TryParseç¤ºä¾‹7.png"></p>
<p>å®é™…ä¸Šåœ¨è½¬æ¢çš„æ—¶å€™ï¼Œ.NETå°†éœ€è¦è½¬æ¢çš„å­—ç¬¦ä¸²è½¬æ¢æˆäº†å­—ç¬¦æŒ‡é’ˆï¼Œç„¶åä¸€ä½ä¸€ä½çš„å»åšå¯¹æ¯”ã€‚å½“è¦å¯¹æ¯”çš„å­—ç¬¦ç­‰äºåƒåˆ†ä½çš„åˆ†éš”ç¬¦æ—¶ç›´æ¥è·³è¿‡ï¼Œç»§ç»­å¯¹æ¯”ä¸‹ä¸€ä½ã€‚å› æ­¤ï¼Œä¸ç®¡å­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ªåˆ†éš”ç¬¦éƒ½æ˜¯å¯ä»¥è½¬æ¢çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="built_in">decimal</span> <span class="keyword">value</span> = <span class="built_in">decimal</span>.Parse(<span class="string">&quot;1,,,,,,,2,,,,3&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="keyword">value</span>);</span><br><span class="line"><span class="comment">//è¾“å‡º 123</span></span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå®é™…ä¸Šè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹è¿œæ¯”æˆ‘æè¿°çš„å¤æ‚ï¼Œæˆ‘è¿™é‡Œåªæ˜¯é’ˆå¯¹æ€§çš„åˆ†æäº†ä¸€ä¸‹è€Œå·²ã€‚<br>
è‡³æ­¤ï¼Œæ•´ä¸ªé—®é¢˜éƒ½æ‰¾åˆ°äº†ç­”æ¡ˆï¼Œåœ†æ»¡æ”¶å®˜ğŸ˜ğŸ˜</p>
]]></content>
      <categories>
        <category>é‚£äº›å¹´é‡Œçš„é‚£äº›å‘</category>
      </categories>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ç®€å•å·¥å‚æ¨¡å¼</title>
    <url>/2021/02/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<p><strong>å®šä¹‰</strong> ç”¨å•ç‹¬ä¸€ä¸ªç±»æ¥åˆ›å»ºå…·ä½“å®ä¾‹çš„è¿‡ç¨‹ã€‚<br>
<strong>ç±»å‹</strong> åˆ›å»ºå‹æ¨¡å¼<br>
<strong>ç‰¹ç‚¹</strong> ä½¿ç”¨å·¥å‚å¯ä»¥å‡å°‘ä»£ç çš„è€¦åˆæ€§ï¼Œä½¿ä»£ç çš„å¯ç»´æŠ¤æ€§å˜é«˜ã€‚é‡åˆ°æ–°çš„éœ€æ±‚æ—¶ï¼Œåªè¦æ–°å¢ä¸€ä¸ªåŠŸèƒ½çš„å®ç°ï¼Œç„¶åé€šè¿‡å·¥å‚å°†å®ä¾‹æ„å»ºå‡ºæ¥å³å¯ã€‚<br>
<strong>ä¸¾ä¾‹</strong> å®ç°ä¸¤ä¸ªæ•°å­—çš„è®¡ç®—ï¼Œè¿ç”¨å·¥å‚åˆ†åˆ«åˆ›å»ºè®¡ç®—åŠ ã€å‡ã€ä¹˜ã€é™¤çš„ä¸åŒå®ä¾‹ã€‚</p>
<p>æœ¬æ–‡ä»¥C#ä¸ºä¾‹ï¼Œå…ˆæ¥çœ‹ç±»å›¾ğŸ”»</p>
<a id="more"></a>
<p><img src="https://i.loli.net/2021/02/18/iGabpmZIz6swuX2.jpg" alt="è®¾è®¡æ¨¡å¼-ç®€å•å·¥å‚æ¨¡å¼.jpg"><br>
æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å…·ä½“åˆ†æä¸€ä¸‹è¿™ä¸ªç±»å›¾ğŸ”»ğŸ”»<br>
å®šä¹‰è¿ç®—ç±»Operationï¼šè¯¥ç±»æ˜¯ä¸€ä¸ª<strong>æŠ½è±¡ç±»</strong>ï¼Œæ‹¥æœ‰NumberAã€NumberBä¸¤ä¸ªå±æ€§ï¼Œä»£è¡¨è¦è®¡ç®—çš„ä¸¤ä¸ªæ•°å­—ï¼›åŒ…å«ä¸€ä¸ªGetResultçš„æ–¹æ³•ï¼Œç”¨äºå¯¹ä¸¤ä¸ªæ•°å­—è¿›è¡Œç›¸åº”çš„è®¡ç®—ã€‚<br>
å®šä¹‰å…·ä½“çš„åŠ æ³•ç±»OperationAddã€å‡æ³•ç±»OperationSubã€ä¹˜æ³•ç±»OperationMulã€é™¤æ³•ç±»OperationDivï¼šè¿™å‡ ä¸ªç±»åˆ†åˆ«<strong>ç»§æ‰¿è‡ªè¿ç®—ç±»Operation</strong>ï¼Œå®ç°å…·ä½“çš„è®¡ç®—é€»è¾‘ã€‚<br>
å®šä¹‰ç®€å•å·¥å‚ç±»OperationFactoryï¼šè¯¥ç±»åŒ…å«ä¸€ä¸ªCreateOperateæ–¹æ³•ï¼Œç”¨äº<strong>æ„é€ è®¡ç®—æ—¶æ‰€éœ€è¦å…·ä½“çš„è¿ç®—ç±»</strong>ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿ç®—ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Operation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> NumberA &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> NumberB &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> åŠ æ³•ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationAdd</span> : <span class="title">Operation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA + NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å‡æ³•ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationSub</span> : <span class="title">Operation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA - NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ä¹˜æ³•ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationMul</span> : <span class="title">Operation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA * NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> é™¤æ³•ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationDiv</span> : <span class="title">Operation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA / NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç®€å•å·¥å‚ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationFactory</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Operation <span class="title">CreateOperation</span>(<span class="params"><span class="built_in">string</span> operationType</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (operationType)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;+&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> OperationAdd();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;-&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> OperationSub();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> OperationMul();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;/&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> OperationDiv();</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;æ— æ•ˆçš„æ“ä½œç¬¦å·&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®šä¹‰å®Œéœ€è¦çš„ä»£ç åï¼Œæˆ‘ä»¬æ¥çœ‹å…·ä½“çš„ä½¿ç”¨æ–¹å¼ğŸ”»</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œä¸åšæ•°æ®ç±»å‹çš„æ ¡éªŒ</span></span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> numberA = Console.ReadLine();</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥æ“ä½œç¬¦ï¼š&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> operationType = Console.ReadLine();</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> numberB = Console.ReadLine();</span><br><span class="line"></span><br><span class="line">Operation operation = <span class="literal">null</span>;</span><br><span class="line">operation = OperationFactory.CreateOperation(operationType);</span><br><span class="line"></span><br><span class="line">operation.NumberA = Convert.ToDouble(numberA);</span><br><span class="line">operation.NumberB = Convert.ToDouble(numberB);</span><br><span class="line"><span class="built_in">double</span> result = operation.GetResult();</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">$&quot;è®¡ç®—ç»“æœä¸ºï¼š<span class="subst">&#123;result&#125;</span>&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ğŸ”»<br>
<img src="https://i.loli.net/2021/02/19/eKJHmwIdrcquvYE.jpg" alt="CodeResult.jpg"></p>
<p>å‚è€ƒèµ„æ–™ï¼š<br>
ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹</p>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>ç®€å•å·¥å‚æ¨¡å¼</tag>
        <tag>åˆ›å»ºå‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ç­–ç•¥æ¨¡å¼</title>
    <url>/2021/02/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<p><strong>å®šä¹‰</strong> ç­–ç•¥æ¨¡å¼å®é™…ä¸Šæ˜¯å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œä»–ä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä½†æ˜¯å¹¶ä¸å½±å“ç®—æ³•çš„è°ƒç”¨è€…ã€‚<br>
<strong>ç±»å‹</strong> è¡Œä¸ºå‹æ¨¡å¼<br>
<strong>ç‰¹ç‚¹</strong> ç®—æ³•å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œå¹¶ä¸ç›¸äº’å½±å“ï¼Œå…·ä½“ç®—æ³•ä¹Ÿä¸ä¼šæš´éœ²ç»™è°ƒç”¨è€…ã€‚<br>
<strong>ä¸¾ä¾‹</strong> è¶…å¸‚ç»“è´¦æ—¶ï¼Œä½¿ç”¨ä¸åŒçš„ä¼˜æƒ æ–¹å¼è¿›è¡Œç»“ç®—ã€‚</p>
<p>æœ¬æ–‡ä»¥C#ä¸ºä¾‹ï¼Œå…ˆæ¥çœ‹ç±»å›¾ğŸ”»</p>
<a id="more"></a>
<p><img src="https://i.loli.net/2021/02/19/U6MiXEn1dYmp2Ob.jpg" alt="è®¾è®¡æ¨¡å¼-ç­–ç•¥æ¨¡å¼.jpg"><br>
CashContextä¸»è¦ç”¨äºç»´æŠ¤ä¸€ä¸ªç­–ç•¥å¯¹è±¡ã€‚<br>
CashNormalï¼ˆæ­£å¸¸ç»“ç®—ï¼‰ã€CashDiscountï¼ˆæŠ˜æ‰£ç»“ç®—ï¼‰ã€StrategyReturnï¼ˆæ»¡å‡ç»“ç®—ï¼‰å‡ç»§æ‰¿è‡ªCashStrategyï¼Œä»£è¡¨å…·ä½“çš„ç­–ç•¥å®ç°ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™å¦‚æœåˆéœ€è¦å¼€å‘ä¸€ä¸ªæ–°çš„ç»“ç®—ç­–ç•¥æ—¶ï¼Œåªéœ€è¦ç»§æ‰¿æŠ½è±¡ç­–ç•¥ï¼Œç„¶åå®ç°æ–°çš„ç®—æ³•å³å¯ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“çš„ä»£ç å®ç°ğŸ”»</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç­–ç•¥ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CashContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> CashStrategy _cashStrategy;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CashContext</span>(<span class="params">CashStrategy cashStrategy</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _cashStrategy = cashStrategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">GetResult</span>(<span class="params"><span class="built_in">double</span> money</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _cashStrategy.DoCalc(money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŠ½è±¡ç­–ç•¥</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">CashStrategy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="built_in">double</span> <span class="title">DoCalc</span>(<span class="params"><span class="built_in">double</span> money</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æ­£å¸¸ç»“ç®—ç­–ç•¥</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CashNormal</span> : <span class="title">CashStrategy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">DoCalc</span>(<span class="params"><span class="built_in">double</span> money</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸ç»“ç®—ï¼Œä¸åšä»»ä½•è®¡ç®—</span></span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æŠ˜æ‰£ç»“ç®—ç­–ç•¥</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CashDiscount</span> : <span class="title">CashStrategy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//è¦ä½¿ç”¨çš„æŠ˜æ‰£</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">double</span> _discount;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CashDiscount</span>(<span class="params"><span class="built_in">double</span> discount</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _discount = discount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">DoCalc</span>(<span class="params"><span class="built_in">double</span> money</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//æŠ˜æ‰£ç»“ç®—</span></span><br><span class="line">        <span class="keyword">return</span> money * _discount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æ»¡å‡ç»“ç®—ç­–ç•¥</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">StrategyReturn</span> : <span class="title">CashStrategy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//æ»¡å‡é…ç½®ï¼Œä¾‹å¦‚ï¼šæ»¡200å‡30</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">double</span> _fullMoney;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">double</span> _returnMoney;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StrategyReturn</span>(<span class="params"><span class="built_in">double</span> fullMoney, <span class="built_in">double</span> returnMoney</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _fullMoney = fullMoney;</span><br><span class="line">        _returnMoney = returnMoney;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">DoCalc</span>(<span class="params"><span class="built_in">double</span> money</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//æ»¡å‡è®¡ç®—</span></span><br><span class="line">        <span class="keyword">if</span> (money &lt; _fullMoney)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> money;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> money - _returnMoney;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…è°ƒç”¨ğŸ”»</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="built_in">double</span> money = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">double</span> payment;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æœ¬æ¬¡æ¶ˆè´¹é‡‘é¢<span class="subst">&#123;money&#125;</span>å…ƒ&quot;</span>);</span><br><span class="line">Console.WriteLine(System.Environment.NewLine);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> normalContext = <span class="keyword">new</span> CashContext(<span class="keyword">new</span> CashNormal());</span><br><span class="line">payment = normalContext.GetResult(money);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æ­£å¸¸ç»“ç®—ç­–ç•¥ï¼Œæœ¬æ¬¡éœ€è¦ä»˜æ¬¾<span class="subst">&#123;payment&#125;</span>å…ƒ&quot;</span>);</span><br><span class="line">Console.WriteLine(System.Environment.NewLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ˜æ‰£</span></span><br><span class="line"><span class="built_in">double</span> discount = <span class="number">0.8</span>;</span><br><span class="line"><span class="keyword">var</span> discountContext = <span class="keyword">new</span> CashContext(<span class="keyword">new</span> CashDiscount(discount));</span><br><span class="line">payment = discountContext.GetResult(money);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æŠ˜æ‰£ç»“ç®—ç­–ç•¥ï¼ŒæŠ˜æ‰£<span class="subst">&#123;discount&#125;</span>ï¼Œæœ¬æ¬¡éœ€è¦ä»˜æ¬¾<span class="subst">&#123;payment&#125;</span>å…ƒ&quot;</span>);</span><br><span class="line">Console.WriteLine(System.Environment.NewLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ»¡100-50</span></span><br><span class="line"><span class="built_in">double</span> fullMoney = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">double</span> returnMoney = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">var</span> returnContext = <span class="keyword">new</span> CashContext(<span class="keyword">new</span> StrategyReturn(fullMoney, returnMoney));</span><br><span class="line">payment = returnContext.GetResult(money);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æ»¡å‡ç»“ç®—ç­–ç•¥ï¼Œæ»¡<span class="subst">&#123;fullMoney&#125;</span>å‡<span class="subst">&#123;returnMoney&#125;</span>ï¼Œæœ¬æ¬¡éœ€è¦ä»˜æ¬¾<span class="subst">&#123;payment&#125;</span>å…ƒ&quot;</span>);</span><br><span class="line">Console.WriteLine(System.Environment.NewLine);</span><br><span class="line"></span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœğŸ”»<br>
<img src="https://i.loli.net/2021/02/19/FmEoGBkPfVCJjtp.jpg" alt="CodeResult.jpg"></p>
<p>å‚è€ƒèµ„æ–™ï¼š<br>
ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹</p>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>ç­–ç•¥æ¨¡å¼</tag>
        <tag>è¡Œä¸ºå‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ä»£ç†æ¨¡å¼</title>
    <url>/2021/02/23/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<p><strong>å®šä¹‰</strong> ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†é€šé“ï¼Œæ¥å®Œæˆå¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚<br>
<strong>ç±»å‹</strong> ç»“æ„å‹æ¨¡å¼<br>
<strong>ç‰¹ç‚¹</strong> å¯ä»¥å¯¹è°ƒç”¨è€…éšè—å®é™…å¯¹è±¡ã€‚<br>
<strong>ä¸¾ä¾‹</strong> å¼ ä¸‰æ›¿æå››è¿½æ±‚ç‹äº”ã€‚</p>
<p>æœ¬æ–‡ä»¥C#ä¸ºä¾‹ï¼Œå…ˆæ¥çœ‹ç±»å›¾ğŸ”»</p>
<a id="more"></a>
<p><img src="https://i.loli.net/2021/02/23/D3Xc2YAfgM9OJer.jpg" alt="è®¾è®¡æ¨¡å¼-ä»£ç†æ¨¡å¼.jpg"></p>
<p>ä»£ç†æ¨¡å¼è¿˜æ˜¯ç›¸å¯¹æ¯”è¾ƒç®€å•å’Œå®¹æ˜“ç†è§£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥çœ‹å…·ä½“çš„ä»£ç å®ç°ğŸ”»</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å®šä¹‰ä¸€ä¸ªä»£ç†å’ŒçœŸå®ç±»å…±ç”¨çš„æ¥å£</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">LoveBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">SendLove</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ä»£ç†ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProxyLove</span> : <span class="title">LoveBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> RealLove _realLove;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SendLove</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–çœŸå®çš„è¡¨ç™½å¯¹è±¡ï¼Œå¹¶è°ƒç”¨çœŸå®çš„è¡¨ç™½æ–¹æ³•</span></span><br><span class="line">        _realLove ??= <span class="keyword">new</span> RealLove();</span><br><span class="line">        _realLove.SendLove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> çœŸå®çš„è¡¨ç™½ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RealLove</span> : <span class="title">LoveBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">SendLove</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;å¼ ä¸‰çœŸå®çš„è¡¨ç™½&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®¢æˆ·ç«¯è°ƒç”¨</span></span><br><span class="line">LoveBase love = <span class="keyword">new</span> ProxyLove();</span><br><span class="line">love.SendLove();</span><br><span class="line"><span class="comment">//ç»“æœè¾“å‡º å¼ ä¸‰çœŸå®çš„è¡¨ç™½</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒèµ„æ–™ï¼š<br>
ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹</p>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>ä»£ç†æ¨¡å¼</tag>
        <tag>ç»“æ„å‹æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>C#çº¿ç¨‹åŒæ­¥æ„é€ </title>
    <url>/2021/03/01/C-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E6%9E%84%E9%80%A0/</url>
    <content><![CDATA[<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œä¸åŒçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯éå¸¸å¸¸è§çš„äº‹æƒ…ã€‚è¿™ç§æƒ…å†µä¸‹å¦‚æœå¤„ç†ä¸å½“ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆä¸é¢„æœŸä¸ç¬¦çš„ç»“æœï¼Œæ‰€ä»¥çº¿ç¨‹åŒæ­¥åœ¨ç¨‹åºé‡Œæœ‰ç€ç›¸å½“é‡è¦çš„ä½œç”¨ã€‚<br>
ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹å¸¸ç”¨çš„ä¸€äº›çº¿ç¨‹åŒæ­¥çš„æ–¹å¼æ–¹æ³•ã€‚ğŸ”»</p>
<a id="more"></a>
<h2 id="æ˜“å˜æ„é€ -volatile"><a class="header-anchor" href="#æ˜“å˜æ„é€ -volatile">Â¶</a>æ˜“å˜æ„é€  volatile</h2>
<p><strong>volatile</strong> å…³é”®å­—æŒ‡ç¤ºä¸€ä¸ªå­—æ®µå¯ä»¥ç”±å¤šä¸ªåŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹ä¿®æ”¹ï¼Œé€šè¿‡ <strong>volatile</strong> å…³é”®å­—ï¼Œå¯ä»¥ä¿è¯å˜é‡åœ¨æ‰§è¡Œä¸Šæœ‰ç€åŸå­æ€§çš„è¯»ã€å†™æ“ä½œã€‚<br>
<strong>volatile</strong> å…³é”®å­—å¯åº”ç”¨äºä»¥ä¸‹ç±»å‹çš„å­—æ®µï¼š</p>
<ul>
<li>å¼•ç”¨ç±»å‹ã€‚</li>
<li>æŒ‡é’ˆç±»å‹ï¼ˆåœ¨ä¸å®‰å…¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼‰ã€‚ è¯·æ³¨æ„ï¼Œè™½ç„¶æŒ‡é’ˆæœ¬èº«å¯ä»¥æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯å®ƒæŒ‡å‘çš„å¯¹è±¡ä¸èƒ½æ˜¯å¯å˜çš„ã€‚ æ¢å¥è¯è¯´ï¼Œä¸èƒ½å£°æ˜â€œæŒ‡å‘å¯å˜å¯¹è±¡çš„æŒ‡é’ˆâ€ã€‚</li>
<li>ç®€å•ç±»å‹ï¼Œå¦‚ sbyteã€byteã€shortã€ushortã€intã€uintã€charã€float å’Œ boolã€‚</li>
<li>å…·æœ‰ä»¥ä¸‹åŸºæœ¬ç±»å‹ä¹‹ä¸€çš„ enum ç±»å‹ï¼šbyteã€sbyteã€shortã€ushortã€int æˆ– uintã€‚</li>
<li>å·²çŸ¥ä¸ºå¼•ç”¨ç±»å‹çš„æ³›å‹ç±»å‹å‚æ•°ã€‚</li>
<li>IntPtr å’Œ UIntPtrã€‚</li>
</ul>
<p>è¿™äº›æè¿°è¯»èµ·æ¥æ¯”è¾ƒç»•å£ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥æ¼”ç¤ºä»¥ä¸‹ <strong>volatile</strong> çš„åŸºæœ¬ç”¨æ³•ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å®šä¹‰æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">VolatileTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> _isStop = <span class="literal">false</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Do</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ä»»åŠ¡å¼€å§‹&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> th = <span class="keyword">new</span> Thread(Thread1);</span><br><span class="line">        th.Start();</span><br><span class="line"></span><br><span class="line">        Thread.Sleep(<span class="number">5000</span>);</span><br><span class="line">        _isStop = <span class="literal">true</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç­‰å¾…ä»»åŠ¡å®Œæˆ&quot;</span>);</span><br><span class="line">        th.Join();</span><br><span class="line"></span><br><span class="line">        Console.ReadLine();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Thread1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!_isStop)</span><br><span class="line">        &#123;</span><br><span class="line">            x = x + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè®¡æ•°ï¼š<span class="subst">&#123;x&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//è°ƒç”¨æµ‹è¯•æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">new</span> VolatileTest().Do();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆæ¥çŒœçŒœä¸Šé¢è¿™æ®µä»£ç çš„æ‰§è¡Œç»“æœæ˜¯æ€æ ·çš„ğŸ˜“ğŸ˜“</p>
<p>ä»£ç åœ¨ç¼–è¯‘æ—¶ï¼Œæ ¹æ®ä¸åŒçš„ç¼–è¯‘é…ç½®ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸åŒçš„ç»“æœã€‚</p>
<ul>
<li>
<p>åœ¨Debugæ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨å¹¶æ²¡æœ‰å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥ç¨‹åºä¼šå¾—åˆ°æ­£å¸¸çš„æ‰§è¡Œç»“æœğŸ”»<br>
<img src="https://i.loli.net/2021/03/01/PvKmZLhQNtl2uM1.jpg" alt="VolatileDebug.jpg"><br>
<em>è‡³äºè¿™é‡Œçš„è®¡æ•°ä¸ºä»€ä¹ˆä¼šæ˜¯è´Ÿæ•°ï¼Œè¿™ä¸ªä»¥åæœ‰æœºä¼šåœ¨å•ç‹¬å†™æ–‡ç« åˆ†æ</em></p>
</li>
<li>
<p>åœ¨Releaseæ¨¡å¼ä¸‹,ç¼–è¯‘å™¨é»˜è®¤æ‰“å¼€äº†ä»£ç ä¼˜åŒ–åŠŸèƒ½ã€‚ç¼–è¯‘VolatileTestæ–‡ä»¶æ—¶ï¼Œç¼–è¯‘å™¨å‘ç°_isStopåœ¨Thread1æ–¹æ³•ä¸­å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸”<strong>å¯¹_isStopçš„æ£€æŸ¥åªä¼šåœ¨å¾ªç¯å‰å‘ç”Ÿä¸€æ¬¡ï¼Œä¸ä¼šæ¯æ¬¡å¾ªç¯æ—¶éƒ½æ£€æŸ¥</strong>ã€‚å› æ­¤ä¼šç”Ÿæˆä¸€æ®µä¸€ç›´ç´¯åŠ xçš„ä»£ç å‡ºæ¥ã€‚å› æ­¤ï¼Œç¨‹åºè¿è¡Œæ—¶ï¼Œå¾—åˆ°äº†ä»¥ä¸‹ç»“æœğŸ”»<br>
<img src="https://i.loli.net/2021/03/01/qkXNTVtiIhaplEu.jpg" alt="VolatileRelease.jpg"></p>
</li>
</ul>
<p>æ¥ä¸‹æ¥é€šè¿‡ILä»£ç æ¥å¯¹æ¯”ä¸€ä¸‹ä¸¤è€…çš„ä¸åŒï¼ˆå·¦è¾¹ä¸ºDebugç‰ˆæœ¬ï¼Œå³è¾¹ä¸ºReleaseç‰ˆæœ¬ï¼‰<br>
<img src="https://i.loli.net/2021/03/01/6GfIXBDxwCpRQkM.jpg" alt="VolatileIL.jpg"><br>
åœ¨ä¸¤ä¸ªç‰ˆæœ¬ä¸­ï¼Œä¸»è¦æœ‰ä¸¤ç‚¹ä¸åŒï¼š</p>
<ol>
<li>Debugç‰ˆæœ¬ä¸­ï¼Œåœ¨åˆå§‹åŒ–å˜é‡æ—¶ï¼Œå®šä¹‰äº†ä¸€ä¸ªboolç±»å‹çš„å˜é‡ï¼›Releaseç‰ˆæœ¬æ²¡æœ‰</li>
<li>Debugç‰ˆæœ¬ä¸­ï¼Œåœ¨å¾ªç¯ç»“æŸå‰ï¼Œå¯¹å®šä¹‰çš„boolå˜é‡å’Œ_isStopè¿›è¡Œäº†è®¡ç®—ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦ç»§ç»­å¾ªç¯ï¼›Releaseç‰ˆæœ¬ä¸­ç›´æ¥è·å–å¹¶æ ¡éªŒäº†_isStopçš„å€¼ï¼Œç»“æœä¸ºfalseï¼Œåˆ™æ— é™å¾ªç¯ã€‚</li>
</ol>
<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ä½¿ç”¨å‰é¢æ‰€è¯´çš„<strong>Volatile</strong>å…³é”®å­—å®šä¹‰å˜é‡å³å¯ã€‚<strong>Volatile</strong>èƒ½ä¿è¯å˜é‡çš„åŸå­æ“ä½œï¼Œå› æ­¤ç”¨<strong>Volatile</strong>å®šä¹‰çš„å˜é‡ï¼Œç¼–è¯‘å™¨æ˜¯ä¸ä¼šè¿›è¡Œä¹‹å‰çš„ä¼˜åŒ–æ“ä½œã€‚<br>
æ‰€ä»¥é‡æ–°ä¿®æ”¹_isStopå˜é‡çš„å®šä¹‰å³å¯ä¿®æ­£å‰é¢çš„é—®é¢˜ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> <span class="built_in">bool</span> _isStop = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼ŒVolatileç±»è¿˜æä¾›äº†ä»¥ä¸‹ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥è¿›è¡Œå˜é‡çš„è¯»å†™ğŸ”»</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Volatile.Read(<span class="keyword">ref</span> _isStop);</span><br><span class="line">Volatile.Write(<span class="keyword">ref</span> _isStop,<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<p>å› æ­¤é€šè¿‡å¦‚ä¸‹ä»£ç ä¹Ÿå¯ä»¥ä¿®æ­£å‰é¢çš„é—®é¢˜ï¼š</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Thread1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//è¿™é‡Œä½¿ç”¨Volatile.Readæ¥è¯»å–æœ€æ–°çš„å€¼</span></span><br><span class="line">    <span class="keyword">while</span> (!Volatile.Read(<span class="keyword">ref</span> _isStop))</span><br><span class="line">    &#123;</span><br><span class="line">        x = x + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè®¡æ•°ï¼š<span class="subst">&#123;x&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¯¹ä¸Šé¢çš„æ¦‚å¿µè¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œé‚£ä¹ˆå¯ä»¥å†å‚è€ƒä¸‹ä¹¦ä¸­çš„è¿™æ ·ä¸€æ®µå®šä¹‰ğŸ”»</p>
<blockquote>
<p>å½“çº¿ç¨‹é€šè¿‡å…±äº«å†…å­˜ç›¸äº’é€šä¿¡æ—¶ï¼Œè°ƒç”¨Volatile.Writeæ¥å†™å…¥æœ€åä¸€ä¸ªå€¼ï¼Œè°ƒç”¨Volatile.Readæ¥è¯»å–ç¬¬ä¸€ä¸ªå€¼</p>
</blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<br>
ã€ŠCLR via C#ã€‹<br>
<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/volatile?f1url=%3FappId%3DDev16IDEF1%26l%3DZH-CN%26k%3Dk(volatile_CSharpKeyword);k(TargetFrameworkMoniker-.NETFramework,Version%253Dv4.5);k(DevLang-csharp)%26rd%3Dtrue">MSDN</a></p>
<p><em><strong>æœ¬æ–‡æœªå®Œï¼Œåé¢è¿˜ä¼šæŒç»­æ›´æ–°ï¼Œå­¦ä¸€ç‚¹æ€»ç»“ä¸€ç‚¹</strong></em>ğŸ¶ğŸ¶</p>
]]></content>
      <categories>
        <category>.NET</category>
      </categories>
      <tags>
        <tag>çº¿ç¨‹åŒæ­¥</tag>
        <tag>Volatile</tag>
      </tags>
  </entry>
</search>
